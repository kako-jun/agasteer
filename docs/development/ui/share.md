## シェア機能

### 概要

リーフのURLやコンテンツをコピーして共有するための機能。パンくずリストから直接アクセス可能。

### 機能

#### 1. URLコピー

現在表示中のページのURLをクリップボードにコピー。

**ユースケース:**

- 同じリーフをスマホとPCで開く
- 他のユーザーに特定のリーフを共有
- ブックマークとして保存

#### 2. Markdownコピー

現在編集中のリーフのMarkdownコンテンツをクリップボードにコピー。

**選択範囲対応:**

- テキストを選択している場合: 選択範囲のみをコピー
- 選択なしの場合: リーフ全体をコピー
- ボタンラベルも選択状態に応じて動的に変化

**ユースケース:**

- 他のMarkdownエディタで編集
- メールやチャットで共有
- 別のノートアプリに移行

#### 3. QRコード表示

シェアメニュー内の「QRコードを表示」ボタンをクリックすると、別モーダルでQRコードを大きく表示。

**選択範囲対応:**

- テキストを選択している場合: 選択範囲のみをQRコード化（ボタンラベルも変化）
- 選択なしの場合: リーフ全体をQRコード化

**仕様:**

- 誤り訂正レベルL（最低）で最大容量を確保
- 最大2,953バイト（UTF-8）まで対応
- 日本語で約980文字程度
- 容量超過時はボタンを非表示（エラーメッセージなし）
- **Priorityリーフの場合**: 生Markdownではなくプレーンテキスト版を使用（`generatePriorityPlainText`）。Priorityリーフはデフォルトでプレビュー表示であり、内部リンクや装飾マークダウンをユーザーに見せない設計のため。

**モーダル表示:**

- 文字数に応じてQRコードサイズを動的に決定（各モジュール最低3px）
- 画面全体の中央に表示（`position: fixed`、ポータルパターンでbody直下に配置）
- 背景クリックまたはEscキーで閉じる
- 余白を最小化して表示領域を最大化（padding: 0.25rem、max: 98vw/98vh）
- 閉じるボタンはモーダル右上角の外側に配置

**ユースケース:**

- スマホのカメラで読み取ってテキストを転送
- オフライン環境でのデータ共有
- 長いテキストから必要な部分だけをQRコード化して転送

**依存ライブラリ:**

- `qrcode` - QRコード生成

#### 4. 画像として共有（Web Share API対応端末のみ）

プレビュー画面または編集画面の内容を画像化してLINE等に直接送信。

**選択範囲対応:**

- テキストを選択している場合: 選択範囲のみを画像化
- 選択なしの場合: 全体を画像化

**表示条件:**

- `navigator.share` と `navigator.canShare` の両方が存在する場合のみボタン表示
- デスクトップブラウザでは通常非表示

### UI実装

パンくずリスト（Breadcrumbs.svelte）にシェアボタンを配置。

**表示条件:**

- リーフ表示時（EditorView, PreviewView）のみ表示
- ホーム画面やノート画面では非表示

### 仕様

- **対象**: リーフのみ（ノートは対象外）
- **左右ペイン**: 各ペインで独立して動作
- **フィードバック**: トースト通知で成功/失敗を通知
- **i18n対応**: 日本語・英語の翻訳あり

---
